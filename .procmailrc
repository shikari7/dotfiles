# $Id$	

# To Do:
# o Subject: get pgp key
# x Subject: TOGGLE ISP (UP|DOWN)
# o send me a given file

#Set on when debugging
VERBOSE=off
 
# supposedly this is necessary for (t)csh users?  (haven't needed it AFAIK)
SHELL=/bin/sh

#Replace `mail' with your mail directory (Pine uses mail, Elm uses Mail)
MAILDIR=$HOME/Mail
     
#Directory for storing procmail log and rc files
PMDIR=$HOME/.procmail
     
# mobile address
PAGER=6123250594@mobile.att.net

# catch any duplicates with a Message-ID cache (before logging)
:0 Wh: $PMDIR/msgid.lock
| formail -D 8192 $PMDIR/msgid.cache

MONTH=`date +%m`
YEAR=`date +%Y`

# logging
LOGDIR=$PMDIR/log/$YEAR
DUMMY=`test -d $LOGDIR || mkdir -p $LOGDIR`
LOGFILE=$LOGDIR/$MONTH

#:0
#* ^Subject: page me
#| sendpage -p XXXXXXXXXX -s %s

# toggle my PPP connection UP
:0
* ^Subject: TOGGLE ISP UP
| toggle-isp --device ppp0 --up

# toggle my PPP connection DOWN
:0
* ^Subject: TOGGLE ISP DOWN
| toggle-isp --device ppp0 --down

# page me with my current IP address
:0
* ^Subject: send ip
| ifconfig ppp0 | mail -s ip-address $PAGER

# page me with the current forecast (defaults to Boston)
:0
* ^Subject: send forecast
| forecast | mail -s forecast $PAGER

# try to catch spam
INCLUDERC=$PMDIR/rc.spam

# mailing list rules and archives
SPOOLDIR=$MAILDIR/mail-incoming
LISTSDIR=$MAILDIR/lists/$YEAR/$MONTH
DUMMY=`test -d $LISTSDIR || mkdir -p $LISTSDIR`
INCLUDERC=$PMDIR/rc.maillists

# global copies of everything not already sent somewhere (e.g. bitbucket)
ARCHIVEDIR=$MAILDIR/archive/mail-incoming/$YEAR
DUMMY=`test -d $ARCHIVEDIR || mkdir -p $ARCHIVEDIR`
MONTHFOLDER=$ARCHIVEDIR/$MONTH
:0 c
$MONTHFOLDER

# send copies of some mail to my pager
##:0 c
# nothing from certain people
##* !^FROM_DAEMON
##* !^From.*Eric.*Hendrickson
# nothing bigger than 10000 bytes
##* < 10000
# no mail lists
##* !^TO.*/dev/null
# try to weed out other forwards
##* !^Subject: F(W|w):
##| resend-mbox -r $PAGER -m -p

# safety net - keep backups of my last 32 messages
:0 c
backup
:0 ic
| cd backup && rm -f dummy `ls -t msg.* | sed -e 1,32d`

# else drop in my mailbox 
